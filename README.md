# FSRCNN

このディレクトリでは，超解像モデルの一種である `FSRCNN` による拡大を試行できる．

```
提案論文："Accelerating the Super-Resolution Convolutional Neural Network"
```
`FSRCNN` は超解像モデルの中では軽量なモデルであり，実行は比較的速いが精度は高くない．より高精度な手法については，モデルを探すか自身で学習を行い，試行してほしい．

なお，当コードは以下のリポジトリを基に作成している．

https://github.com/yjn870/FSRCNN-pytorch

## 実行方法
### Python3のインストール
python3の実行環境を用意する．

WindowsであればWSLのUbuntuがおススメ．UbuntuであればデフォルトでPython3がインストール済み．(インストールされていなければ，aptでインストールすること)

### 必要なパッケージのインストール
実行に必要なパッケージをインストールする．

```
sudo pip3 install -r requirements.txt
```

足りないパッケージがあれば実行時にエラーが出るので，必要に応じて追加でインストールすること．

### 実行
```
python3 fsrcnn.py
```

これで，`./LR` 内の画像を `FSRCNN` で超解像した結果が `./SR` に保存される．

## オプション
### 拡大倍率の変更
`-s` コマンドで，拡大倍率を2倍，3倍，4倍から指定できる．(未指定なら4倍)
```
python3 fsrcnn.py -s 3
```
上記のコマンドでは，3倍に拡大する．

### 入出力ディレクトリの変更
`-i` コマンドで入力する画像のディレクトリ，`-o` コマンドで出力するディレクトリの名前を指定できる．
```
python3 fsrcnn.py -i ./INDIR -o ./OUTDIR
```
上記のコマンドでは，`./INDIR` 下の画像が超解像され，`./OUTDIR` 下に保存される．

# 一般的な拡大手法との比較

一般的な手法による拡大を行い，超解像画像との精度を比較できる．

## 拡大の実行

`upscale.py` を実行することで，`./LR` 内の画像をバイキュービック法により拡大し，`./UP` に出力できる．

```
python3 upscale.py
```

### オプション
拡大倍率および入出力ディレクトリの変更は，`fsrcnn.py` と同様に行うことができる．

また，`-m` コマンドで拡大手法を変更できる．引数には0~3を指定でき，以下の表で対応している手法により拡大される．デフォルト値は2となっている．

|引数|拡大手法|
|:---:|:---:|
|0|ニアレストネイバ法|
|1|バイリニア法|
|2|バイキュービック法|
|3|Lanczos法|

## 超解像の定量的評価
超解像画像と一般的手法による拡大画像は，目視で精度を確認するのみでなく定量的に評価できる．

評価には，用意した高解像度な正解画像(GT)と出力された拡大画像の類似度を用いる．正解画像に類似しているほど，拡大の精度が高いと言える．なお，サンプルとして用意した `Town.jpg` の2倍，3倍，4倍の正解画像は `./GT` 下に用意している．

評価には `eval.py` を用い，`-i` で入力する拡大画像のパス，`-gt` で正解画像のパスを指定することで，`PSNR`，`SSIM`，`LPIPS` を評価できる．(各指標については修士論文の３章に記す)

## 実行例
まず，`FSRCNN` による超解像の画像と正解画像の類似度を，以下の実行で評価する．
```
python3 eval.py -i SR/FSRCNN_x4Town.jpg -gt GT/GT_x4Town.png
```
これにより，以下の出力を得る．
```
PSNR  : 22.88156079169824
SSIM  : 0.6474227749860736
LPIPS : 0.4203808307647705
```

次に，バイキュービック法による拡大画像と正解画像の類似度を，以下の実行で評価する．
```
python3 eval.py -i UP/CUB_x4Town.jpg -gt GT/GT_x4Town.png
```
これにより，以下の出力を得る．
```
PSNR  : 22.42072183367837
SSIM  : 0.6156659070553402
LPIPS : 0.5553099513053894
```

上記の出力を表にまとめると，以下のようになる．

|指標|FSRCNN|バイキュービック|
|:---:|:---:|:---:|
|PSNR|22.882|22.421|
|SSIM|0.647|0.616|
|LPIPS|0.420|0.555|

`PSNR` および `SSIM` は値が大きいほど高評価，`LPIPS` は値が小さいほど高評価であるため，いずれの手法においても `FSRCNN` がバイキュービックに比べ高精度に拡大できていると分かる．

# まとめ
本ディレクトリでは，`FSRCNN` による超解像と一般的な手法による拡大を行える．また，超解像画像と拡大画像の精度比較を行える．

サンプル画像で実行できた後は，自身で画像を用意して行うと面白いかと思う．# Acceleration_FSSR
# acceleration_FSSR
# acceleration_FSSR
# acceleration_FSSR
